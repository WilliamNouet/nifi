morphlines : [
    {
        id : test
        importCommands : [
            "org.kitesdk.morphline.stdio.ReadLineBuilder",
            "org.kitesdk.morphline.stdlib.TryRulesBuilder",
            "org.kitesdk.morphline.stdlib.GrokBuilder",
            "org.kitesdk.morphline.stdlib.SplitBuilder",
            "org.kitesdk.morphline.stdlib.ConvertTimestampBuilder",
            "org.kitesdk.morphline.stdlib.SetValuesBuilder",
        ]

        commands : [
            {
                readLine {
                    charset : UTF-8
                }
            }

            {
                tryRules {
                    catchExceptions : true
                    throwExceptionIfAllRulesFailed : true
                    rules : [
                        {
                            commands : [
                                {
                                    grok {
                                        dictionaryString : """
                                            MONTH \b(?:Jan(?:uary)?|Feb(?:ruary)?|Mar(?:ch)?|Apr(?:il)?|May|Jun(?:e)?|Jul(?:y)?|Aug(?:ust)?|Sep(?:tember)?|Oct(?:ober)?|Nov(?:ember)?|Dec(?:ember)?)\b
                                            MONTHDAY (?:(?:0[1-9])|(?:[12][0-9])|(?:3[01])|[1-9])
                                            TIME (?!<[0-9])%{HOUR}:%{MINUTE}(?::%{SECOND})(?![0-9])
                                            HOUR (?:2[0123]|[01]?[0-9])
                                            MINUTE (?:[0-5][0-9])
                                            SECOND (?:(?:[0-5][0-9]|60)(?:[:.,][0-9]+)?)
                                            HOSTNAME \b(?:[0-9A-Za-z][0-9A-Za-z-]{0,62})(?:\.(?:[0-9A-Za-z][0-9A-Za-z-]{0,62}))*(\.?|\b)
                                            IP (?<![0-9])(?:(?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2})[.](?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2})[.](?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2})[.](?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2}))(?![0-9])
                                            DATA .*?
                                            GREEDYDATA .*
                                            SYSLOGTIMESTAMP %{MONTH} +%{MONTHDAY} %{TIME}
                                            SYSLOGHOST (?:%{HOSTNAME}|%{IP})
                                            POSINT \b(?:[1-9][0-9]*)\b
                                        """
                                        expressions : {
                                            message : """%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:syslog_hostname} %{DATA:syslog_program}(?:\[%{POSINT:syslog_pid}\])?: %{GREEDYDATA:syslog_message}"""
                                        }
                                    }
                                }

                                {
                                    convertTimestamp {
                                        field : syslog_timestamp
                                        inputFormats : ["MMM d HH:mm:ss"]
                                        outputFormat : "unixTimeInMillis"
                                    }
                                }

                                {
                                    setValues {
                                        key : "success"
                                        value : "@{syslog_timestamp},@{syslog_hostname},@{syslog_program},@{syslog_message}"
                                    }
                                }
                            ]
                        }

                        # Handle exception
                        {
                            commands : [
                                {
                                    setValues {
                                        key : "exception"
                                        value : "@{message}"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        ]
    }
]
